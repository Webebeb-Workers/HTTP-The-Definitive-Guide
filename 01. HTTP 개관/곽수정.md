# 1. HTTP 개관

HTTP(Hypertext Transfer Protocol)에 대해 맛보기로 알아보는 챕터

## 1.1 HTTP: 인터넷의 멀티미디어 배달부

- 웹 서버로부터 대량의 정보를 빠르고 간편하게 웹브라우저로 옮겨주는 역할 수행
- 신뢰성 있는 데이터 전송 프로토콜 사용: 정보 손상 / 순서 불일치 문제 걱정하지 않아도 됨

## 1.2 웹 클라이언트와 서버

### 웹 서버 = HTTP 서버

- 웹 콘텐츠가 존재하는 곳
- 인터넷의 데이터를 저장하고, 클라이언트가 요청한 데이터 제공

### 웹 클라이언트 = HTTP 클라이언트

- 구글 크롬과 같은 웹 브라우저가 한 예
- 서버에게 HTTP 객체를 요청하고 사용자의 화면에 보여줌

### 웹 클라이언트 ↔️ 서버

`http://www.oreilly.com/index.html` 페이지 접속 상황

1. 웹 브라우저가 `www.oreilly.com 서버`로 HTTP 요청 송신
2. 서버는 요청 받은 객체(`index.html`)을 찾아 성공 시 타입, 길이와 함께 HTTP 응답에 포함해 송신

## 1.3 리소스

웹 리소스: 웹 서버가 관리하는 웹 콘텐츠의 원천

**정적 파일**

- e.g. 텍스트 파일, HTML 파일, 워드 파일, JPEG 이미지 파일, AVI 동영상 파일 등

**동적 파일**

- 사용자가 누구인지, 어떤 정보인지, 몇 시인지에 따라 다른 콘텐츠를 생성함
- e.g. 라이브 영상, 주식 거래, 부동산 DB 검색 등 (웹 캠 게이트웨이, 주식 거래 게이트웨이, 부동산 게이트웨이, 전자상거래 게이트웨이)

### 1.3.1 미디어 타입

**MIME 타입**: Multipurpose Internet Mail Extensions의 약자, 다목적 인터넷 메일 확장

- 원래 각기 다른 전자메일 시스템 사이에서 메시지 송/수신 문제를 해결하기 위해 설계된 데이터 포맷 라벨
- HTTP에서도 멀티미디어 콘텐츠를 기술하고 라벨을 붙이기 위해 채택됨
- 웹 서버는 모든 HTTP 객체 데이터에 MIME 타입 붙여 송신함
  - 이를 통해 웹 브라우저가 이미지 파일을 보여주거나 HTML 파일을 분석 및 포맷팅 하거나 특별한 포맷의 파일을 다루기 위해 외부 플러그인 소프트웨어를 실행함

> [!NOTE]
>
> MIME 타입: `주 타입 (primary object type) / 부 타입 (specific subtype)`으로 이루어진 문자열 라벨
>
> e.g. `Content-type: image/jpeg`
>
> `text/html`: HTML로 작성된 텍스트 문서
>
> `text/plain`: plain ASCII 텍스트 문서
>
> `image/jpeg`: JPEG 이미지
>
> `image/gif`: GIF 이미지
>
> `video/quicktime`: 애플 퀵타임 동영상
>
> `application/vnd.ms-powerpoint`: PPT

### 1.3.2 URI

**URI**: 서버 리소스 이름, 즉 통합 자원 식별자 (uniform resource identifier)

- 인터넷의 우편물 주소 같은 거심, 정보 리소스를 고유하게 식별하고 위치를 지정할 수 있음
- e.g. `http://www.jeos-hardware.com/specials/saw-blade.gif`와 같은 URI로 HTTP가 객체 찾아옴
- URI에는 URL과 URN이 존재함

### 1.3.3 URL

**URL**: 통합 자원 지시자 (uniform resource locator)

- 리소스 식별자의 가장 흔한 현태며 특정 서버의 한 리소스에 대한 구체적인 위치 서술

> [!NOTE]
>
> 1. `scheme(스킴)`: 리소스 접근 시 사용되는 프로토콜 (HTTP)
>
> 2. `인터넷 주소`: 서버의 인터넷 주소 (www.joes-hardware.com)
>
> 3. `웹 서버의 리소스`: (/specials/saw-blade.gif)

- http://www.oreilly.com/index.htinl: 오라일리 출판사 홈페이지의 URL
- http://www.yahoo.com/images/logo.gif: 야후! 웹 사이트 로고의 URL
- http://www.joes-hardware.com/inventory-check.cgi?item=12731: 물품 #12731의 재고가 있는지 확인하는 프로그램에 대한 URL
- ftp://joe:tools4나©ftp.joes-hardware.com/locking-pliers.gif: 비밀번호로 보호되는 FTP를 통해 이미지 파일에 접근하는 URL

### 1.3.4 URN

**URN**: 유니폼 리소스 이름 (uniform resource name)

- 콘텐츠를 이루는 한 리소스에 대해 그 리소스 위치에 영향을 받지 않는 유일무이한 이름 역할
- 여러 종류의 네트워크 접속 프로토콜로 접근해도 문제 없음
- e.g. `urn:ietf:rfc:2141`: 인터넷 표준 문서 RFC 2141을 지칭하기 위한 URN
- 아직 실험 중인 상태 (인프라 자원 부재로 채택이 늦어짐)

## 1.4 트랜잭션

**HTTP 트랜잭션**: 요청 명령 (클라이언트 ➡️ 서버) & 응답 결과 (서버 ➡️ 클라이언트)로 구성됨

### 1.4.1 메서드

**HTTP 메서드**: 모든 HTTP 요청 메시지가 갖는 요청 명령 (서버가 취해야할 동작)

- `GET`: 서버에서 클라이언트로 지정한 리소스를 보내라
- `PUT`: 클라이언트에서 서버로 보낸 데이터를 지정한 이름의 리소스로 저장하라
- `DELETE`: 지정한 리소스를 서버에서 삭제해라
- `POST`: 클라이언트 데이터를 서버 게이트웨이 애플리케이션으로 보내라
- `HEAD`: 지정한 리소스에 대한 응답에서, HTTP 헤더 부분만 보내라

### 1.4.2 상태 코드

**HTTP 상태 코드**: 클라이언트에게 요청이 성공했는지, 추가 조치가 필요한지 알려주는 세 자리 숫자

- `200`: 굿 문서가 바르게 반환되었다.
- `302`: 다시 보내라. 다른 곳에 가서 리소스를 가져가라.
- `404`: 없음. 리소스를 찾을 수 없다.

### 1.4.3 웹페이지는 여러 객체로 이루어질 수 있다.

- 웹 페이지는 첨부된 리소스들에 대해 각각 별개의 HTTP 트랜잭션을 필요로 함
- HTML을 한 번의 트랜잭션으로 가져온 뒤, 이미지, 그래픽 조각 등을 가져오기 위한 추가 HTTP 트랜잭션 수행 가능

## 1.5 메시지

<img width="575" alt="image" src="https://github.com/user-attachments/assets/8c7f98f4-f3bd-4af8-8c26-421470de7c75" />

> [!NOTE]
>
> **시작줄**: 요청이라면 무엇을 해야 하는지, 응답이라면 무슨 일이 일어났는지 표기
>
> **헤더**: 0개 이상의 헤더 필드, 쌍점(:)으로 구분되어 있는 하나의 이름과 하나의 값으로 구성됨, 빈 줄로 끝남
>
> **본문**: 필요에 따라 메세지 본문 표기, 요청의 본문 - 웹 서버로 데이터 전달, 응답의 본문 - 클라이언트로 데이터 반환 (이진 데이터, 텍스트 포함 가능)

### 1.5.1 간단한 메시지의 예

<img width="572" alt="image" src="https://github.com/user-attachments/assets/363bcfee-b5e8-40b2-ab27-32bb27b0e0e6" />

## 1.6 TCP 커넥션

**TCP**: Transmission Control Protocol, 전송 제어 프로토콜

### 1.6.1 TCP/IP

- HTTP: 애플리케이션 계층 프로토콜
- HTTP는 네트워크 통신의 세부사항에 대해 신경 쓰지 않고 대신 TCP/IP에게 맡김
  - 오류 없는 데이터 전송
  - 순서에 맞는 전달 (데이터는 언제나 보낸 순서대로 도착한다)
  - 조각나지 않는 데이터 스트림 (언제든 어떤 크기로든 보낼 수 있다)
- TCP/IP는 각 네트워크와 하드웨어 특성을 숨기고, 어떤 종류의 컴퓨터나 네트워크든 서로 신뢰성 있는 의사소통 가능케함

<img width="572" alt="image" src="https://github.com/user-attachments/assets/d332cb87-ff86-42f2-b58c-3701dc014202" />

### 1.6.2 접속, IP 주소 그리고 포트번호

- HTTP 클라이언트가 서버에 메시지를 전송할 수 있게 되기 전에, 인터넷 프로토콜 (IP) 주소와 포트번호를 사용해 클라이언트 ↔️ 서버 TCP/IP 커넥션을 맺어야 함
- URL을 통해 HTTP 서버의 IP 주소와 포트번호를 알아낼 수 있음
  - `http://207.200.83.29:80/index.html`: IP주소는 207.200.83.29, 포트 번호는 80
  - `http://www.netscape.com:80/index.html`: 도메인 이름 혹은 호스트 명 ➡️ 도메인 이름 서비스 (DNS) 통해 IP 변환 가능, 포트 번호는 80
  - `http://www.netscape.com/index.html`: 포트 번호 없는 경우 기본값이 80

<img width="574" alt="image" src="https://github.com/user-attachments/assets/f948c741-f74c-465c-8f39-6784552549fe" />

> (a) 웹브라우저는 서버의 URL에서 호스트 명을 추출한다.
>
> (b) 웹브라우저는 서버의 호스트 명을 IP로 변환한다.
>
> (c) 웹브라우저는 URL에서 포트번호(있다면)를 추출한다.
>
> (d) 웹브라우저는 웹 서버와 TCP 커넥션을 맺는다.
>
> (e) 웹브라우저는 서버에 HTTP 요청을 보낸다.
>
> (f) 서버는 웹브라우저 에 HTTP 응답을 돌려준다.
>
> (g) 커넥션이 닫히면, 웹브라우저는 문서를 보여준다.

> 1.6.3 텔넷(Telnet)을 이용한 실제 예제 생략

## 1.7 프로토콜 버전

**HTTP/0.9**

- GET 메서드만 지원
- MIME 타입, HTTP 헤더, 버전 번호 지원 X
- 간단한 HTML 객체 받아오는 용도

**HTTP/1.0**

- HTTP 헤더, 추가 메서드, MIME 타입 추가

**HTTP/1.0+**

- keep-alive 커넥션, 가상 호스팅 지원, 프락시 연결 추가

**HTTP/1.1**

- HTTP 설계의 구조적 결함 교정, 성능 최적화, 오기능 제거
- 현재의 HTTP 버전

**HTTP/2.0**

- 성능 문제를 개선하기 위한 구글의 SPDY 프로토콜 기반 설계 진행 중인 프로토콜

## 1.8 웹의 구성요소

- **프락시**: 클라이언트와 서버 사이에 위치한 HTTP 중개자
- **캐시**: 많이 찾는 웹페이지를 클라이언트 가까이에 보관하는 HTTP 창고
- **게이트웨이**: 다른 애플리케이션과 연결된 특별한 웹 서버
- **터널**: 단순히 HTTP 통신을 전달하기만 하는 특별한 프락시
- **에이전트**: 자동화된 HTTP 요청을 만드는 준지능적 웹클라이언트

### 1.8.1 프락시

- 웹 보안, 애플리케이션 통합, 성능 최적화를 위한 중요한 구성요소인 HTTP 프락시 서버
- 클라이언트의 모든 HTTP 요청을 받아 대개 요청을 수정한 뒤 서버에 전달 (사용자를 대신해서 서버에 접근)
- 주로 보안을 위해 사용됨, 신뢰할만한 중개자 역할: 요청과 응답 필터링
- e.g. 회사 내부망에서 바이러스 검출, 초등학교에서 성인 콘텐츠 차단

### 1.8.2 캐시

- **웹 캐시 & 캐시 프락시**: 자신을 거쳐 가는 문서들 중 자주 찾는 것의 사본을 저장해두는 특별한 종류의 HTTP 프락시 서버
- 클라이언트는 멀리 떨어진 웹 서버보다 근처의 캐시에서 훨씬 더 빨리 문서를 다운 받을 수 있음

<img width="572" alt="image" src="https://github.com/user-attachments/assets/a85a816a-8c13-4cf6-82c9-dae32c05b9a1" />

### 1.8.3 게이트웨이

- 다른 서버들의 중개자로 동작하는 특별한 서버
- 주로 HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용됨
- 스스로가 리소스를 갖고 있는 진짜 서버인 것처럼 요청을 다루고, 클라이언트는 이를 알아채지 못함
- e.g. HTTP/FTP 게이트웨이: FTP URI에 대한 HTTP 요청을 받아들여 FTP 프로토콜을 이용해 문서를 가져오고 받아온 문서는 HTTP 메시지에 담겨 클라이언트에게 보냄

### 1.8.4 터널

- 두 커넥션 사이트 raw 데이터를 열어보지 않고 그대로 전달해주는 HTTP 애플리케이션
- 주로 비 HTTP 데이터를 하나 이상의 HTTP 연결을 통해 그대로 전송해주기 위해 사용됨
- e.g. HTTP/SSL 터널: HTTP 요청을 받아들여 목적지의 주소와 포트번호로 커넥션을 맺고 이후에는 암호화된 SSL 트래픽을 HTTP 채널을 통해 목적지 서버로 전송할 수 있게 됨 (웹 트래픽만 허용하는 사내 방화벽)

<img width="575" alt="image" src="https://github.com/user-attachments/assets/b7328f63-1ef2-43a0-9ea7-871153356ba4" />

### 1.8.5 에이전트

- 사용자를 위해 HTTP 요청을 만들어주는 클라이언트 프로그램
- 웹 브라우저 외에도 웹 요청을 만드는 애플리케이션은 뭐든 HTTP 에이전트임
- e.g. 사람의 통제 없이 스스로 웹을 돌아다니며 HTTP 트랜잭션을 일으키고 콘텐츠를 받아오는 자동화된 사용자 에이전트 (스파이더, 웹로봇)
  - 스파이더는 웹을 돌아다니며 검색 엔진의 DB나 가격비교 로봇을 위한 제품 카탈로그와 같은 유용한 웹 콘텐츠 보관소를 만듦
