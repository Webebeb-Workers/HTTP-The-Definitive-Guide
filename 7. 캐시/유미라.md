# 1. 불필요한 데이터 전송
- 서버는 동일한 문서를 여러 클라이언트에게 반복 전송하며 불필요한 데이터 전송이 발생한다. 
- 이는 네트워크 대역폭을 낭비하고 서버 부하를 증가시킨다. 
- `캐시`를 활용하면 첫 번째 응답을 저장하고 이후 요청에 재사용하여 중복 트래픽을 줄일 수 있다.

# 2. 대역폭 병목
<img width="575" alt="image" src="https://github.com/user-attachments/assets/0194187d-57f8-4410-a64d-db74eac859b7" />

- 원격 서버보다 로컬 네트워크가 더 빠르기 때문에, 캐시된 데이터를 가져오면 전송 속도가 크게 향상된다. 
- 네트워크 대역폭과 종류에 따라 전송 속도 차이가 크며, 캐싱은 특히 큰 문서 전송 시 효과적이다.

# 3. 갑작스런 요청 쇄도（Flash Crowds）
<img width="574" alt="image" src="https://github.com/user-attachments/assets/7f42e54f-a510-42af-9bff-4c54bfcddcb6" />

- 속보로 인해 다수가 동시에 웹 문서에 접근하면 네트워크와 서버에 과부하가 걸릴 수 있다.
- 캐싱을 활용하면 이러한 트래픽 급증으로 인한 장애를 줄일 수 있다.

# 4. 거리로 인한 지연
<img width="570" alt="image" src="https://github.com/user-attachments/assets/d100a085-e4aa-4865-b7f4-3c95108b8b4e" />

- 라우터를 거치면서 트래픽이 지연될 뿐만 아니라, 빛의 속도 자체도 유의미한 지연을 초래한다.
- 하지만 캐시를 활용하면 데이터 전송 거리를 줄일 수 있다.

# 5. 적중과 부적중
<img width="576" alt="image" src="https://github.com/user-attachments/assets/37c939f7-f739-4404-af4d-300899905d74" />

- **캐시 적중** : 요청에 대응하는 사본이 캐시에 있을 경우, 해당 사본을 이용해 요청을 처리한다.
- **캐시 부적중** : 요청에 대응하는 사본이 캐시에 없을 경우, 원 서버로 요청을 전달한다.

## 5.1 재검사
### 재검사
- 캐시된 사본이 최신인지 주기적으로 확인하기 위해 원 서버와 확인하는 과정이다.
- 전체 객체를 가져오지 않고 빠르게 신선도를 확인할 수 있는 요청을 HTTP에서 제공한다.

### 재검사 적중
<img width="578" alt="image" src="https://github.com/user-attachments/assets/b39b3da2-75c7-4f6c-94a1-14210f056542" />

- 캐시가 사본의 신선도를 검사하기 위해 원 서버에 작은 요청을 보낸다.
- 콘텐츠가 변경되지 않으면, 서버는 304 Not Modified 응답을 보내고 캐시는 해당 사본을 신선하다고 표시한 뒤 클라이언트에 제공한다.
- 재검사 적중은 원 서버와의 검사를 거쳐야 하므로 캐시 적중보다 느리지만, 캐시 부적중보다는 빠르다.

### HTTP 도구
- `If-Modified-Since` 헤더를 사용하여 서버에게 해당 시간 이후에 변경된 경우만 사본을 요청한다.
- 서버 응답:
    - 변경되지 않은 경우: `304 Not Modified`
    - 변경된 경우: 새 객체와 함께 `200 OK`
    - 삭제된 경우: `404 Not Found`

## 5.2 적중률
- 캐시 적중률(문서 적중률)은 요청 처리에서 캐시가 처리한 비율을 나타내며, 0%는 모든 요청이 부적중, 100%는 모든 요청이 적중임을 의미한다.
- 적중률은 캐시 크기, 사용자 관심사, 데이터 변경 빈도 등에 따라 달라지며, 40%의 적중률도 좋은 편으로 간주된다. 
- 캐시는 자주 사용되는 문서를 보관해 트래픽을 줄이고 성능을 향상시킨다.

### 5.3 바이트 적중률
- 문서 적중률은 모든 문서의 접근을 나타내지만, 크기가 다른 문서들로 인해 전체 트래픽을 정확히 반영하지 못한다. 이를 보완하기 위해 바이트 단위 적중률이 사용된다.
- 바이트 단위 적중률은 캐시에서 제공된 바이트의 비율을 나타내며, 100%는 모든 트래픽이 캐시에서 왔음을 의미한다.
- 문서 적중률은 웹 트랜잭션의 외부 요청을 줄여 대기 시간을 줄이고, 바이트 단위 적중률은 대역폭 절약을 최적화한다.

> Q. 트래픽과 대역폭의 관계?

### 5.4 적중과 부적중의 구별
- HTTP는 클라이언트에게 응답이 캐시 적중인지 원 서버 접근인지를 알 수 있는 방법을 제공하지 않는다.
- 일부 프락시 캐시는 Via 헤더에 추가 정보를 포함하지만, 클라이언트는 Date 헤더를 사용해 응답의 생성일을 비교하거나, Age 헤더를 사용해 응답이 얼마나 오래되었는지 확인할 수 있다.

# 6. 캐시 토폴로지
<img width="573" alt="image" src="https://github.com/user-attachments/assets/52cad860-de1b-4101-8287-18f28ec2fea4" />

- **개인 전용 캐시 (private cache)** : 한 명의 사용자만을 위한 캐시, 해당 사용자만 자주 찾는 페이지를 저장한다.
- **공유된 캐시 (public cache)** : 여러 사용자가 공유하는 캐시, 사용자 집단에게 자주 쓰이는 페이지를 저장한다.

## 6.1 개인 전용 캐시
- **개인 전용 캐시** : 웹 브라우저 내장, 자주 쓰이는 문서를 디스크와 메모리에 캐시해 놓는다.
- 브라우저 캐시 관리: 사용자 설정으로 캐시 사이즈 조정 가능, 캐시된 문서를 확인할 수 있다.
  - 예: 인터넷 익스플로러에서는 "임시 파일"로 저장하며, 구글 크롬은 about:cache를 통해 캐시 콘텐츠를 확인할 수 있다.

> Q. about:cache는 현재 크롬에서 더 이상 사용할 수 없나?

## 6.2 공용 프락시 캐시
<img width="568" alt="image" src="https://github.com/user-attachments/assets/f255ebd4-9127-4ce2-8eb3-e4c376dc247a" />

- 공용 캐시(프락시 캐시)는 여러 사용자가 공유하는 캐시로, 자주 요청되는 문서를 한 번만 가져와서 모든 사용자에게 제공함으로써 네트워크 트래픽을 줄인다.
- 개인 전용 캐시에서는 각 사용자가 동일한 문서를 여러 번 네트워크를 통해 가져오지만, 공용 캐시는 이를 한 번만 가져와서 여러 사용자가 공유하게 된다.
- 프락시 캐시는 수동으로 설정하거나 자동설정 파일을 통해 브라우저에서 사용하도록 할 수 있다.
- 또한, 인터셉트 프락시를 사용하면 브라우저 설정 없이 HTTP 요청을 캐시를 거치도록 강제할 수 있다.

## 6.3 프락시 캐시 계층들
<img width="574" alt="image" src="https://github.com/user-attachments/assets/3e40a76b-d99f-45f6-873b-78221c141de6" />

- 작은 캐시에서 캐시 부적중이 발생하면 더 큰 부모 캐시가 트래픽을 처리하는 계층 구조가 효율적이다.
- 클라이언트 근처에는 작은 캐시를 사용하고, 상위 계층에서는 많은 사용자가 공유하는 문서를 저장한다.
- 캐시 계층이 깊어지면 요청은 여러 캐시를 거쳐야 하며, 프락시 연쇄가 길어질수록 성능 저하가 발생할 수 있다.

## 6.4 캐시망, 콘텐츠 라우팅, 피어링
<img width="573" alt="image" src="https://github.com/user-attachments/assets/a66b12d6-26c0-4c9b-8d2a-6b4fb69d1af2" />

- 몇몇 네트워크 아키텍처는 복잡한 캐시망을 만들어, 프락시 캐시가 동적으로 부모 캐시나 원 서버로 요청을 보낸다. 
    - URL에 근거하여 부모 캐시와 원 서버 중 하나를 동적으로 선택한다.
    - URL에 근거하여 특정 부모 캐시를 동적으로 선택한다.
    - 부모 캐시에게 가기 전에 캐시된 사본을 로컬에서 찾아본다.
    - 다른 캐시들이 그들의 캐시된 콘텐츠에 부분적으로 접근할 수 있도록 허용하되, 그들의 캐시를 통한 인터넷 트랜짓（Internet transit）’은 허용하지 않는다.
- 다른 조직들이 상호 이득을 위해 캐시를 연결하여 콘텐츠를 공유하고, 선택적 피어링을 지원하는 캐시는 `형제 캐시`라 불린다.
- HTTP는 형제 캐시를 지원하지 않으므로 ICP나 HTCP로 확장된다.

> ICP와 HTCP란?
