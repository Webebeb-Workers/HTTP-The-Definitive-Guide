# 6. 프락시

- 웹 프락시 서버는 클라이언트와 서버 사이의 중개자임
- 프락시는 클라이언트와 서버 사이에 위치하여 사이에서 HTTP 메시지를 정리하는 역할을 함

## 6.1 웹 중개자

<img width="425" alt="Image" src="https://github.com/user-attachments/assets/650efdcd-dfad-4d93-8162-ba254b3f837d" />

**프락시의 기본 동작**

- 프락시는 클라이언트를 대신해 트랜잭션을 수행하는 중개인임
- 프락시가 없으면 클라이언트가 HTTP 서버와 직접 통신함
- 프락시가 있으면 클라이언트는 프락시와 통신하고, 프락시가 서버와 통신을 대행함

**프락시의 이중 역할**

- 프락시는 웹 서버와 웹 클라이언트의 특성을 모두 가짐
- 클라이언트로서: 서버에 요청을 보내고 응답을 받아 처리함
- 서버로서: 클라이언트의 요청과 커넥션을 처리하고 응답을 제공함
- HTTP 프락시 개발 시 클라이언트와 서버 양쪽의 HTTP 규칙을 모두 준수해야 함

### 6.1.1 개인 프락시와 공유 프락시

**공용 프락시**

- 여러 클라이언트가 공유하여 사용하는 프락시
- 특징:
  - 대부분의 프락시는 공용이며 공유된 프락시임
- 장점:
  - 중앙 집중형 관리로 비용 효율적이고 관리가 용이함
  - 캐시 프락시의 경우 사용자가 많을수록 공통 요청에서 더 큰 이점을 얻을 수 있음

**개인 프락시**

- 단일 클라이언트가 독점적으로 사용하는 프락시
- 특징:
  - 흔하지는 않지만 꾸준히 사용되고 있음
  - 주로 클라이언트 컴퓨터에서 직접 실행됨
  - 브라우저 보조 제품 형태로 사용
- 주요 용도:
  - 브라우저 기능 확장
  - 성능 개선
  - 무료 ISP 서비스를 위한 광고 운영

> ISP가 뭐지?, 실제 예시가 뭐가 있을까?

### 6.1.2 프락시 대 게이트웨이

<img width="419" alt="Image" src="https://github.com/user-attachments/assets/e654ae2e-1137-4508-8380-15e9b8499613" />

**기본 개념 차이**

- 프락시: 동일한 프로토콜을 사용하는 애플리케이션들을 연결
- 게이트웨이: 서로 다른 프로토콜을 사용하는 애플리케이션들을 연결

**게이트웨이의 특징**

- 프로토콜 변환기 역할을 수행
- 서로 다른 프로토콜 간의 트랜잭션 완료를 지원
- 예시: HTTP/POP 게이트웨이
  - HTTP로 들어온 요청을 POP 이메일 프로토콜로 변환하고, 사용자가 이메일을 HTTP를 통해 읽을 수 있게 해줌
  - 웹 기반 이메일 서비스(Yahoo Mail, MSN Hotmail 등)가 대표적

**현실적 구분의 모호성**

- 브라우저와 서버가 다른 버전의 HTTP일 때 프락시도 HTTP 버전 간 변환 수행같은 약간의 프로토콜 변환을 하기도 함
- 상용 프락시 서버들은 다양한 게이트웨이 기능 포함:

  - SSL 보안 프로토콜
  - SOCKS 방화벽
  - FTP 접근
  - 웹 기반 애플리케이션 지원

- 이처럼 이론적 구분과 달리 실제로는 프락시와 게이트웨이의 경계가 불분명한 경우가 많음

> SOCKS, FTP, SSL 이 정확히 뭐지??

## 6.2 왜 프락시를 사용하는가?

- 프락시 서버는 보안 개선, 성능 개선, 비용 절약 등 실용적이고 유용한 일을 함
- 프락시는 모든 HTTP 트래픽을 들여다보고 건드릴 수 있기 때문에, 부가적인 가치를 주는 여러 유용한 웹 서비스를 구현하기 위해 트래픽을 감시하고 수정할 수 있음

### 어린이 필터

<img width="419" alt="Image" src="https://github.com/user-attachments/assets/8bcb8fc8-6f90-4b0c-b6fe-0ff7e174fdf4" />

**핵심 기능**

- 학교에서 사용되는 필터링 프락시
- 교육용 콘텐츠와 유해 콘텐츠를 선별적으로 통제

**예시**

- 허용: 교육 콘텐츠에 대한 제한 없는 접근
- 차단: 어린이에게 부적절한 사이트 접근 강제 거부

> 어떻게 이게 가능한걸까? 어떤 기준으로 허용하고 차단하는걸까??

### 문서 접근 제어자

<img width="419" alt="Image" src="https://github.com/user-attachments/assets/a9ff613b-8b77-4f77-8e14-4f4686128d41" />

**핵심 기능**

- 여러 웹 서버와 리소스에 대한 중앙화된 접근 제어 제공
- 접근 기록에 대한 감사 추적 수행
- 대기업 환경이나 분산된 관료 조직에서 유용함

**장점**

- 개별 웹 서버마다 접근 제어를 설정할 필요 없음
- 중앙 프락시에서 일괄적으로 접근 권한 관리 가능

**예시**

- 클라이언트 1 에게 제약 없이 서버의 뉴스 페이지에 접근할 수 있도록 허가
- 클라이언트 2에게 제약 없이 인터넷 콘텐츠에 접근할 수 있는 권한을 줌
- 클라이언트 3이 서버 B에 접근하기 전에 먼저 비밀번호를요구

### 보안 방화벽

<img width="418" alt="Image" src="https://github.com/user-attachments/assets/503479bc-972b-4bb9-ba89-2510388dc3f9" />

**핵심 기능**

- 보안 강화
- 프로토콜 흐름 통제: 조직 내부/외부 트래픽을 네트워크의 한 지점에서 통제
- 트래픽 검사: 네트워크 트래픽을 세밀하게 검사하고 조취할 수 있는 hook 제공
  - 바이러스 검사
  - 트래픽 내용 분석
  - 악성 코드 제거
  - 유해 콘텐츠 필터링

> 방화벽이랑 방화벽 프락시는 뭐가 다를까?

### 웹 캐시

<img width="416" alt="Image" src="https://github.com/user-attachments/assets/b9dd11c4-eca8-4830-b657-2635ff416358" />

**핵심 기능**

- 자주 요청되는 문서의 로컬 복사본 저장 및 관리
- 저장된 문서에 대한 요청 시 빠른 응답 제공

**장점**

- 느리고 비싼 인터넷 커뮤니케이션을 줄임

### 대리 프락시

<img width="417" alt="Image" src="https://github.com/user-attachments/assets/f968c470-c9e4-4c02-a404-85465ebb50ef" />

**핵심 기능**

- 웹 서버처럼 위장하여 동작(리버스 프락시로도 불림)
- 요청받은 콘텐츠를 다른 서버에서 찾아옴

**장점**

- 서버 가속기

  - 공용 콘텐츠에 대한 느린 웹 서버의 성능 개선

- 콘텐츠 분산

  - 콘텐츠 라우팅과 결합되어 주문형 복제 콘텐츠의 분산 네트워크 구성
  - ex) 편의점처럼, 본사(메인 서버)의 상품을 각 지역 편의점(지역 서버)에 미리 배치해두는 것과 같은 개념

> 대리 프락시를 둔다고 어떻게 웹 서버의 성능을 개선한다는걸까??

### 콘텐츠 라우터

<img width="424" alt="Image" src="https://github.com/user-attachments/assets/be827dab-29ce-4f11-a240-288becab8a55" />

**핵심 기능**

- 트래픽 상태와 콘텐츠 유형에 따라 요청을 적절한 웹 서버로 전달
- 다양한 맞춤형 서비스 제공 가능

**예시**

- 성능 향상 서비스

  - 프리미엄 사용자의 요청을 가까운 캐시 서버로 전달
  - 더 빠른 응답 속도 제공

- 필터링 서비스

  - 필터링 서비스 가입자의 요청을 필터링 프락시로 전달
  - 콘텐츠 필터링 서비스 제공

### 트랜스코더

<img width="420" alt="Image" src="https://github.com/user-attachments/assets/de006db9-5624-41a2-8bf1-4e931d33df11" />

**핵심 기능**

- 콘텐츠의 본문을 변환

**예시**

- 이미지 변환

  - GIF → JPG 변환으로 용량 축소
  - 이미지 크기 조정
  - TV용 색상 강도 조절

- 텍스트 처리

  - 텍스트 파일 압축
  - 모바일 기기용 텍스트 크기 축소
  - 언어 번역 (한국어 → 스페인어)

### 익명화 프락시

<img width="418" alt="Image" src="https://github.com/user-attachments/assets/b71a2387-28ec-4146-a398-1cb0daa7e67a" />

**핵심 기능**

- HTTP 메시지에서 사용자 신원 식별 정보를 제거
- 개인 정보 보호와 익명성 보장

**예시**

- User-Agent 헤더 에서 사용자의 컴퓨터 와 OS의 종류를 제거
- 사용자의 이메일 주소를 보호하기 위해 From 헤더 제거
- 어떤 사이트를 거쳐서 방문했는지 알기 어 렵게 하기 위해 Referer 헤더 제거
- 프로필과 신원 정보를 없애기 위해 Cookie 헤더 제거
