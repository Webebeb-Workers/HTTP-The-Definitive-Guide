# 5. 웹 서버

- 웹 서버는 날씨 정보 제공, 온라인 쇼핑, 친구 찾기 등 다양한 기능을 수행하며 월드 와이드 웹의 핵심 역할을 함
- 월드 와이드 웹(www) : 인터넷 상에서 하이퍼텍스트 문서를 검색하고 접근할 수 있는 시스템으로, 우리가 흔히 사용하는 웹사이트와 웹페이지를 포함하는 공간

## 5.1 다채로운 웹 서버

- 웹 서버 소프트웨어와 웹페이지 제공에 특화된 하드웨어를 카리킴
- 간단한 Perl 스크립트, 대형 상용 서버, 소형 기판 서버 등 기능/크기/형태가가 다양함
- 모든 웹 서버는 HTTP 요청을 받아 리소스나 콘텐츠를 클라이언트에게 반환함

### 5.1.1 웹 서버 구현

**웹 서버의 역할**

- HTTP 프로토콜을 구현함
- 웹 리소스를 관리함
- 웹 서버 관리 기능을 제공함
- TCP 커넥션 관리 책임을 운영체제와 나눠가짐

**운영체제의 지원**

- TCP/IP 네트워크, 파일 시스템, 프로세스 관리 등을 통해 웹 서버의 기능 보조

**웹 서버의 구현 형태**

- 표준 컴퓨터 시스템에서 실행되는 다목적 소프트웨어 웹 서버
- 전자기기 내부의 마이크로프로세서 기반 내장형 웹 서버

### 5.1.2 다목적 소프트웨어 웹 서버

<img width="414" alt="Image" src="https://github.com/user-attachments/assets/48aff166-44df-495a-867d-13fe3a66b09f" />

**기본 특성**

- 다목적 소프트웨어 웹 서버는 네트워크에 연결된 표준 컴퓨터 시스템에서 동작함
- 대부분의 컴퓨터와 운영체제에서 동작함
- 웹 서버 프로그램으로 오픈소스(아파치, W3C 직소)나 상용 소프트웨어(마이크로소프트, 아이플래닛)를 사용할 수 있음

**시장 현황**

- 전체 웹 서버 중 주요 몇 개의 소프트웨어만 널리 사용됨
- 마이크로소프트(37%), 아파치(35%), nginx(14%)가 시장의 대부분 점유
- nginx는 최근 지속적 성장세 기록

> Q. 표는 꽤 오래전 이야기인데 지금은 어떨까?

### 5.1.3 임베디드 웹 서버

**정의:**

- 일반 소비자용 제품에 내장되는 소형 웹 서버
- ex) 프린터나 가전제품 등에 탑재

**주요 특징:**

- 매우 작은 크기 (1제곱인치 미만도 가능)
- 보통 최소한의 기능만 제공함
- 웹 브라우저를 통한 기기 관리 인터페이스를 제공함

## 5.2 간단한 펄 웹 서버

**HTTP 서버의 규모:**

- 완전한 기능의 HTTP 서버(예: 아파치)는 5만 줄 이상의 코드로 돼있고, 부가적인 처리 모듈들을 더하면 훨씬 커짐
- HTTP/1.1 의 기능들을 지원하려면, 풍부한 리소스 지원, 가상 호스팅, 접근 제어, 로깅, 설정, 모니터 링, 그 외 성능을 위한 각종 기능들이 필요
- 최소 기능의 HTTP 서버는 30줄 미만의 펄(Perl) 코드로도 구현 가능

**type-o-serve 프로그램:**

- 간단한 펄(Perl) 기반 웹 서버 프로그램
- HTTP 요청 메시지를 화면에 출력하고, 클라이언트가 응답 메시지를 입력하도록 설계됨.
- 클라이언트-프락시 간 상호작용 테스트에 유용한 진단 도구임

**type-o-serve 프로그램의 작동 방식:**

1. HTTP 연결 대기
2. 요청 메시지 수신 및 화면 출력
3. 사용자가 입력한 응답 메시지를 클라이언트에게 전송

**type-o-serve 프로그램으로 HTTP 통신을 테스트하는 예시**

- 아래 사진은 죠의 하드웨어 상점의 관리자가 type-o-serve를 이용해 어떻게 HTTP 통신을 테스트하는지 보여줌

<img width="416" alt="Image" src="https://github.com/user-attachments/assets/5a76e3af-c53f-4711-8a9d-feca9bd58428" />

1. 관리자는 특정 포트로 수신하는 type-o-serve 진단 서버를 시작

- 죠의 하드웨어 상점 웹 서버는 80포트로 수신하고 있기 때문에 관리자는 `% type-o-serve.pl 8080` 명령을 입력해 type-o-serve 서버를 8080번 포트로 시작함

2. type-o-serve가 동작하기 시작한 후, 죠의 하드웨어 상점 웹 서버에 브라우저로 접근할 수 있음

- `http：//www.joes-hardware.com：8080/foo/bar/blah.txt`에 접근

3. type-o-serve 프로그램은 브라우저로부터 HTTP 요청 메시지를 받아 그 내용을 화면에 출력한 뒤, 관리자가 마침표 하나뿐인 줄로 끝나는 간단한 응답 메시지를 입력할 때까지 기다림

4. type-o-serve는 HTTP 응답 메시지를 브라우저에게 돌려주고, 브라우저는 응답 메시지의 본문을 화면에 출력함

## 5.3 진짜 웹 서버가 하는 일

<img width="418" alt="Image" src="https://github.com/user-attachments/assets/8ea53117-3a48-42bd-bfda-76550d984e72" />

- 최신형 상용 웹 서버가 일반적으로 수행하는 주요 작업은 다음과 같음

1. `커넥션`: 클라이언트의 접속을 받아들이거나 원치 않는 클라이언트라면 연결을 닫음
2. `요청 수신`: HTTP 요청 메시지를 네트워크로부터 읽어 들임
3. `요청 처리`: 요청 메시지를 해석하고 적절한 행동을 취함
4. `리소스 접근`: 요청 메시지에서 지정한 리소스에 접근함
5. `응답 생성`: 올바른 헤더를 포함한 HTTP 응답 메시지를 생성함
6. `응답 송신`: 응답 메시지를 클라이언트에게 전달함
7. `로그 남기기`: 트랜잭션 완료에 대한 정보를 로그 파일에 기록함
